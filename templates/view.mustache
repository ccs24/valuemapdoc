{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
}}
<div class="valuemapdoc-view">

    <!-- COMPACT TOOLBAR -->
    <div class="valuemapdoc-toolbar border-bottom pb-2 mb-3">
        
        <!-- Row 1: Zarządzanie -->
        <div class="toolbar-row d-flex align-items-center py-1">
            <span class="toolbar-label">Zarządzanie:</span>
            
            {{#groupoptions}}
            <select id="groupfilter" class="form-select form-select-sm me-2" style="width: auto;">
                {{#groupoptions}}
                <option value="{{@key}}">{{.}}</option>
                {{/groupoptions}}
            </select>
            {{/groupoptions}}
            
            <a href="{{{import_url}}}" class="btn btn-sm btn-outline-secondary me-1">Import</a>
            <a href="{{{export_url}}}" class="btn btn-sm btn-outline-secondary me-1">Export</a>
            <a href="{{{preferences_url}}}" class="btn btn-outline-info btn-sm">
                    <i class="fa fa-cog"></i> {{#str}}change_field_level, mod_valuemapdoc{{/str}}
                </a>
        </div>
        <!-- Row 2: Dokumenty -->
        {{#can_generate}}
        <div class="toolbar-row d-flex align-items-center py-1">
            <span class="toolbar-label">Dokumenty:</span>
            
            <select id="templateid" class="form-select form-select-sm me-2" style="width: 200px;">
                <option value="">Wybierz szablon</option>
                {{#tempselect}}
                <option value="{{id}}">{{name}}</option>
                {{/tempselect}}
            </select>
            
            <input type="text" id="filenameprefix" class="form-control form-control-sm me-2" 
                   style="width: 120px;" placeholder="Prefix">
            
            <button id="generate-button" class="btn btn-sm btn-success me-2" disabled>
                Generuj
            </button>

            <a href="{{{content_url}}}" class="btn btn-sm btn-outline-secondary me-1">Content</a>

        </div>
        {{/can_generate}}

        <!-- Row 3: Master (only if not master instance) -->
        {{^is_master_instance}}
        <div class="toolbar-row d-flex align-items-center py-1">
            <span class="toolbar-label">Master:</span>
            
            <select id="masterfilter" class="form-select form-select-sm me-2 {{classmaster}}" style="width: 250px;">
                <option value="">Wybierz bazę master</option>
                {{#masteroptions}}
                <option value="{{key}}" {{#selected}}selected{{/selected}}>{{label}}</option>
                {{/masteroptions}}
            </select>
            
            <button id="move-to-master-button" class="btn btn-sm btn-warning me-2" disabled>
                Przekaż do Master
            </button>
        </div>
        {{/is_master_instance}}

        <!-- Row 4: Tabela -->
        <div class="toolbar-row d-flex align-items-center justify-content-between py-1">
            <div class="d-flex align-items-center">
                <span class="toolbar-label">Tabela:</span>
                
                {{#can_add}}
                <a href="{{{add_url}}}" class="btn btn-sm btn-success me-1">+ Nowy rekord</a>
                {{/can_add}}
                
                <button id="empty-bulk-button" class="btn btn-sm btn-outline-success me-1">+ Empty Line</button>
                
                <!-- Bulk actions (shown when rows selected) -->
                <div id="bulk-actions" style="display: none;">
                    {{#can_edit}}
                    <button id="edit-bulk-button" class="btn btn-sm btn-primary me-1">Edit Selected</button>
                    {{/can_edit}}
                    <button id="duplicate-bulk-button" class="btn btn-sm btn-outline-primary me-1">Duplicate</button>
                    {{#can_delete}}
                    <button id="delete-bulk-button" class="btn btn-sm btn-danger me-1">Delete</button>
                    {{/can_delete}}
                </div>
            </div>
            
            <div class="d-flex align-items-center">
                <input type="text" id="valuemap-search" class="form-control form-control-sm me-2" 
                       style="width: 150px;" placeholder="Szukaj">
                <button id="toggle-fullscreen" class="btn btn-sm btn-outline-secondary">Full Screen</button>
            </div>
        </div>
    </div>

    <!-- MAIN TABLE -->
    <div id="valuemap-table-container" class="table-responsive">
        <div id="valuemap-table-js" 
             data-columns="{{{columns}}}"
             data-courseid="{{courseid}}"
             data-cmid="{{cmid}}"
             data-filtercmid="{{filtercmid}}">
        </div>
    </div>
</div>



<script type="application/json" id="valuemap-columns">
{{{columns}}}
</script>


